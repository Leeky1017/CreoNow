import{j as t}from"./jsx-runtime-BLchON5X.js";import{R as p}from"./index-DDi9LDaq.js";import{B as a}from"./Button-B9XLIlTV.js";import{I as z}from"./Input-BR80orUP.js";import"./Textarea-C3DI-yW7.js";import"./Card-D2dqmnxE.js";import{L as P}from"./ListItem-CyD6nTsv.js";import{T as l}from"./Text-CW-Kyc9R.js";import"./Heading-BzOyC2Oj.js";import"./Dialog-DJV5UiAm.js";import"./Popover-BMinsKFS.js";import"./Select-DBTPtHXT.js";import"./Checkbox-Ddw3urWg.js";import"./Tabs-DmRrGnuH.js";import"./Badge-0PIbcpDO.js";import"./Avatar-CFHo7YSR.js";import"./Spinner-BG3j59Um.js";import"./Skeleton-CwzwMFJo.js";import"./Tooltip-Ca9CUhYJ.js";import"./Toast-HPSiDIc2.js";import"./Accordion-F8I8yqG1.js";import"./Radio-DYZtN_dz.js";import{u as h}from"./editorStore-ByocGlaq.js";import{u as r}from"./fileStore-6FVttjBc.js";function S(s){const f=r(e=>e.items),x=r(e=>e.currentDocumentId),v=r(e=>e.bootstrapStatus),m=r(e=>e.lastError),b=r(e=>e.createAndSetCurrent),g=r(e=>e.rename),w=r(e=>e.delete),k=r(e=>e.setCurrent),C=r(e=>e.clearError),j=h(e=>e.openDocument),y=h(e=>e.openCurrentDocumentForProject),[n,c]=p.useState({mode:"idle"}),u=p.useRef(null);p.useEffect(()=>{n.mode==="rename"&&(u.current?.focus(),u.current?.select())},[n.mode]);async function N(){const e=await b({projectId:s.projectId});e.ok&&await j({projectId:s.projectId,documentId:e.data.documentId})}async function D(e){const i=k({projectId:s.projectId,documentId:e});await j({projectId:s.projectId,documentId:e}),await i}async function I(){n.mode!=="rename"||!(await g({projectId:s.projectId,documentId:n.documentId,title:n.title})).ok||c({mode:"idle"})}async function E(e){!window.confirm("Delete this document?")||!(await w({projectId:s.projectId,documentId:e})).ok||await y(s.projectId)}return t.jsxs("div",{"data-testid":"sidebar-files",className:"flex flex-col min-h-0",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-[var(--color-separator)]",children:[t.jsx(l,{size:"small",color:"muted",children:"Files"}),t.jsx(a,{"data-testid":"file-create",variant:"secondary",size:"sm",onClick:()=>{N()},children:"New"})]}),m?t.jsxs("div",{role:"alert",className:"p-3 border-b border-[var(--color-separator)]",children:[t.jsxs(l,{size:"small",className:"mb-2 block",children:[m.code,": ",m.message]}),t.jsx(a,{variant:"secondary",size:"sm",onClick:()=>C(),children:"Dismiss"})]}):null,t.jsx("div",{className:"flex-1 overflow-auto min-h-0",children:v!=="ready"?t.jsx(l,{size:"small",color:"muted",className:"p-3 block",children:"Loading filesâ€¦"}):f.length===0?t.jsx(l,{size:"small",color:"muted",className:"p-3 block",children:"No documents yet."}):t.jsx("div",{className:"flex flex-col gap-1 p-2",children:f.map(e=>{const i=e.documentId===x,d=n.mode==="rename"&&n.documentId===e.documentId;return t.jsxs(P,{"data-testid":`file-row-${e.documentId}`,"aria-selected":i,selected:i,interactive:!d,compact:!0,onClick:()=>{d||D(e.documentId)},className:`border ${i?"border-[var(--color-border-focus)]":"border-[var(--color-border-default)]"}`,children:[t.jsx("div",{className:"flex-1 min-w-0",children:d?t.jsx(z,{ref:u,"data-testid":`file-rename-input-${e.documentId}`,value:n.title,onChange:o=>c({mode:"rename",documentId:e.documentId,title:o.target.value}),onKeyDown:o=>{if(o.key==="Escape"){c({mode:"idle"});return}o.key==="Enter"&&(o.preventDefault(),I())},fullWidth:!0,className:"h-7 text-xs"}):t.jsx(l,{size:"small",className:"block overflow-hidden text-ellipsis whitespace-nowrap",children:e.title})}),t.jsx("div",{className:"flex gap-1",children:d?t.jsxs(t.Fragment,{children:[t.jsx(a,{"data-testid":`file-rename-confirm-${e.documentId}`,variant:"secondary",size:"sm",onClick:o=>{o.stopPropagation(),I()},children:"Save"}),t.jsx(a,{variant:"ghost",size:"sm",onClick:o=>{o.stopPropagation(),c({mode:"idle"})},children:"Cancel"})]}):t.jsxs(t.Fragment,{children:[t.jsx(a,{"data-testid":`file-rename-${e.documentId}`,variant:"ghost",size:"sm",onClick:o=>{o.stopPropagation(),c({mode:"rename",documentId:e.documentId,title:e.title})},children:"Rename"}),t.jsx(a,{"data-testid":`file-delete-${e.documentId}`,variant:"ghost",size:"sm",onClick:o=>{o.stopPropagation(),E(e.documentId)},children:"Delete"})]})})]},e.documentId)})})})]})}S.__docgenInfo={description:`FileTreePanel renders the project-scoped documents list (DB SSOT) and actions.

Why: P0-015 requires a minimal documents loop with stable selectors for Windows E2E.`,methods:[],displayName:"FileTreePanel",props:{projectId:{required:!0,tsType:{name:"string"},description:""}}};export{S as F};
