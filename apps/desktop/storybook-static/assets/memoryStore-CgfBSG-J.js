import{R as l}from"./index-DDi9LDaq.js";import{c as f}from"./react-Cb9lVK8B.js";const p=l.createContext(null);function S(o){async function i(){return await o.invoke("memory:settings:get",{})}async function u(e){return await o.invoke("memory:list",e?{projectId:e}:{})}return f((e,s)=>({projectId:null,items:[],settings:null,preview:null,bootstrapStatus:"idle",lastError:null,clearError:()=>e({lastError:null}),clearPreview:()=>e({preview:null}),bootstrapForProject:async t=>{const r=s();if(r.bootstrapStatus==="loading"&&r.projectId===t)return;e({bootstrapStatus:"loading",lastError:null,projectId:t,preview:null});const n=await i();if(!n.ok){e({bootstrapStatus:"error",lastError:n.error});return}const a=await u(t);if(!a.ok){e({bootstrapStatus:"error",lastError:a.error,settings:n.data});return}e({bootstrapStatus:"ready",lastError:null,projectId:t,settings:n.data,items:a.data.items})},refresh:async()=>{const t=s(),r=await u(t.projectId);if(!r.ok){e({lastError:r.error});return}e({items:r.data.items,lastError:null})},create:async({type:t,scope:r,content:n})=>{const a=s();if(r==="project"&&!a.projectId){const d={code:"INVALID_ARGUMENT",message:"projectId is required for project scope"};return e({lastError:d}),{ok:!1,error:d}}const m={type:t,scope:r,content:n},y=r==="project"?{...m,projectId:a.projectId}:m,c=await o.invoke("memory:create",y);return c.ok?(s().refresh(),c):(e({lastError:c.error}),c)},remove:async({memoryId:t})=>{const r=await o.invoke("memory:delete",{memoryId:t});return r.ok?(s().refresh(),r):(e({lastError:r.error}),r)},updateSettings:async({patch:t})=>{const r=await o.invoke("memory:settings:update",{patch:t});return r.ok?(e({settings:r.data,lastError:null}),r):(e({lastError:r.error}),r)},previewInjection:async({queryText:t})=>{const r=s(),n=r.projectId?{projectId:r.projectId,queryText:t}:{queryText:t},a=await o.invoke("memory:injection:preview",n);if(!a.ok){e({lastError:a.error});return}e({preview:a.data,lastError:null})}}))}function v(o){return l.createElement(p.Provider,{value:o.store},o.children)}function k(o){const i=l.useContext(p);if(!i)throw new Error("MemoryStoreProvider is missing");return i(o)}v.__docgenInfo={description:"Provide a memory store instance for the Workbench UI.",methods:[],displayName:"MemoryStoreProvider",props:{store:{required:!0,tsType:{name:"ReturnType",elements:[{name:"createMemoryStore"}],raw:"ReturnType<typeof createMemoryStore>"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};export{v as M,S as c,k as u};
