import{R as f}from"./index-DDi9LDaq.js";import{c as y}from"./react-Cb9lVK8B.js";const k=f.createContext(null);function v(n){async function i(r){return await n.invoke("file:document:list",{projectId:r})}async function w(r){return await n.invoke("file:document:getCurrent",{projectId:r})}async function u(r,s){return await n.invoke("file:document:setCurrent",{projectId:r,documentId:s})}async function E(r,s){return await n.invoke("file:document:create",{projectId:r,title:s})}return y((r,s)=>({projectId:null,items:[],currentDocumentId:null,bootstrapStatus:"idle",lastError:null,clearError:()=>r({lastError:null}),refreshForProject:async t=>{const a=await i(t);if(!a.ok){r({lastError:a.error});return}const e=await w(t),o=e.ok?e.data.documentId:null;r({projectId:t,items:a.data.items,currentDocumentId:o})},bootstrapForProject:async t=>{const a=s();if(a.bootstrapStatus==="loading"&&a.projectId===t)return;r({projectId:t,bootstrapStatus:"loading",lastError:null,items:[],currentDocumentId:null});const e=await i(t);if(!e.ok){r({bootstrapStatus:"error",lastError:e.error});return}const o=await w(t);if(o.ok){r({bootstrapStatus:"ready",items:e.data.items,currentDocumentId:o.data.documentId,lastError:null});return}if(o.error.code!=="NOT_FOUND"){r({bootstrapStatus:"error",items:e.data.items,lastError:o.error});return}const S=e.data.items[0]?.documentId??null;if(S){const m=await u(t,S);if(!m.ok){r({bootstrapStatus:"error",items:e.data.items,lastError:m.error});return}r({bootstrapStatus:"ready",items:e.data.items,currentDocumentId:m.data.documentId,lastError:null});return}const c=await E(t);if(!c.ok){r({bootstrapStatus:"error",lastError:c.error});return}const l=await u(t,c.data.documentId);if(!l.ok){r({bootstrapStatus:"error",lastError:l.error});return}const d=await i(t);if(!d.ok){r({bootstrapStatus:"error",lastError:d.error});return}r({bootstrapStatus:"ready",items:d.data.items,currentDocumentId:l.data.documentId,lastError:null})},createAndSetCurrent:async({projectId:t,title:a})=>{const e=await E(t,a);if(!e.ok)return r({lastError:e.error}),e;const o=await u(t,e.data.documentId);return o.ok?(await s().refreshForProject(t),o):(r({lastError:o.error}),o)},rename:async({projectId:t,documentId:a,title:e})=>{const o=await n.invoke("file:document:rename",{projectId:t,documentId:a,title:e});return o.ok?(await s().refreshForProject(t),o):(r({lastError:o.error}),o)},delete:async({projectId:t,documentId:a})=>{const e=await n.invoke("file:document:delete",{projectId:t,documentId:a});return e.ok?(await s().refreshForProject(t),e):(r({lastError:e.error}),e)},setCurrent:async({projectId:t,documentId:a})=>{const e=s().currentDocumentId;r({currentDocumentId:a});const o=await u(t,a);return o.ok?(r({currentDocumentId:o.data.documentId}),o):(r({currentDocumentId:e,lastError:o.error}),o)}}))}function R(n){return f.createElement(k.Provider,{value:n.store},n.children)}function D(n){const i=f.useContext(k);if(!i)throw new Error("FileStoreProvider is missing");return i(n)}R.__docgenInfo={description:"Provide a file store instance for the Workbench UI.",methods:[],displayName:"FileStoreProvider",props:{store:{required:!0,tsType:{name:"ReturnType",elements:[{name:"createFileStore"}],raw:"ReturnType<typeof createFileStore>"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};export{R as F,v as c,D as u};
