## 1. Implementation
- [ ] 1.1 Add unified diff generator + unit tests
- [ ] 1.2 Add DiffView + Apply/Reject UI in AiPanel
- [ ] 1.3 Add selectionRef capture + conflict detection + TipTap apply
- [ ] 1.4 Extend IPC/service for `actor=ai` writes (`ai-apply:<runId>`)

## 2. Testing
- [ ] 2.1 Add Windows E2E: `ai-apply.spec.ts` (success + conflict + log evidence)
- [ ] 2.2 Run `pnpm typecheck`, unit tests, and E2E

## 3. Documentation
- [ ] 3.1 Update RUN_LOG: `openspec/_ops/task_runs/ISSUE-40.md`
