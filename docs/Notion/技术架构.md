# 🏗️ 技术架构

## 技术栈总览

| **层级** | **技术选型** | **说明** |
| --- | --- | --- |
| 桌面框架 | Electron | 跨平台桌面应用，Windows-first |
| 前端框架 | React 18 + TypeScript | 类型安全的组件化 UI |
| 构建工具 | Vite | 快速开发与构建 |
| 样式方案 | Tailwind CSS 4 | 原子化 CSS |
| 富文本编辑器 | TipTap 2 | 基于 ProseMirror 的可扩展编辑器 |
| 状态管理 | Zustand | 轻量级状态管理 |
| 本地存储 | SQLite | 本地持久化 |

---

## 核心模块架构

### 1. 上下文引擎（Context Engine）

- 分层上下文管理（Rules / Settings / Retrieved / Immediate）
- Token 预算分配与裁剪策略
- Stable prefix hash → Prompt caching

### 2. 知识图谱模块（Knowledge Graph）

- 实体管理：角色、地点、事件、物品、阵营
- 关系管理：实体之间的关联
- 语义检索：为 AI 推理提供结构化上下文

### 3. 记忆系统（Memory System）

- 写作偏好学习与个性化权重
- 交互反馈积累
- 确定性降级策略

### 4. 技能系统（Skill System）

- 技能抽象层：context_rules + 执行逻辑
- 三级作用域：builtin → global → project
- 内置技能 + 用户自定义技能

### 5. 版本管理（Version Control）

- 快照生成与存储
- AI 修改标记（actor=ai）
- Diff 对比引擎
- 版本恢复

---

<aside>
💡

*此页面为架构概览，随着开发推进持续补充细节。*

</aside>