# CN 审计整改实施编排（Swarm Lead）

## 1. 角色分工

- governance-steward：治理门禁与 RUN_LOG 合规。
- change-architect：变更任务拆分与规格维护。
- dependency-orchestrator：依赖拓扑与 `EXECUTION_ORDER` 维护。
- implementation-foreman：实施派工与波次推进。
- audit-duo-coordinator：双层审计调度。
- owner-approval-reviewer：Owner 代审评分卡执行。

## 2. 实施波次

- Wave 0（基础层）
  - `aud-c1a-renderer-safeinvoke-contract`
  - `aud-c2a-test-runner-discovery`
  - `aud-c3a-ipc-session-project-binding`
  - `aud-h1-export-stream-write`
  - `aud-h2a-main-hotpath-async-io`
  - `aud-h3-watcher-error-recovery-state`
  - `aud-h5-preload-payload-size-protocol`
  - `aud-m1-ai-runtime-config-centralization`
  - `aud-m2-shared-token-budget-helper`

- Wave 1（依赖收敛层）
  - `aud-c1b-renderer-async-state-convergence`
  - `aud-c2b-main-unit-suite-inclusion`
  - `aud-c3b-ipc-assert-project-access`
  - `aud-h2b-main-io-offload-guard`
  - `aud-h4-judge-eval-retry-safety`
  - `aud-m3-test-token-estimator-parity`
  - `aud-m4-preload-diagnostic-metadata`

- Wave 2（治理门禁层）
  - `aud-c1c-renderer-fireforget-lint-guard`
  - `aud-c2c-executed-vs-discovered-gate`
  - `aud-h6a-main-service-decomposition`
  - `aud-m5-coverage-gate-artifacts`

- Wave 3（架构拆分层）
  - `aud-h6b-memory-document-decomposition`
  - `aud-h6c-renderer-shell-decomposition`

## 3. 每项 change 的执行闭环

1. 实施 Agent 完成当前 change 的 Red/Green/Refactor 与证据落盘。
2. 触发第一层审计：`audit-agent-A` 全量审查并输出 findings。
3. 触发第二层审计：`audit-agent-B` 交叉复核第一层结论与遗漏风险。
4. 实施 Agent 按 findings 修复并回归。
5. Lead 终审：签发 ACCEPT/REJECT。
6. 仅在 Lead ACCEPT 后，进入 PR 合并流程。

## 4. 阻断规则

- 任一 change 未通过双层审计：禁止进入合并。
- 任一 wave 存在阻断项：下游依赖 wave 不得启动。
- `EXECUTION_ORDER.md` 未同步：禁止宣称执行顺序已确认。
