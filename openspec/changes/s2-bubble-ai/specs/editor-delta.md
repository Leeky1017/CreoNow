# Editor Specification Delta

## Change: s2-bubble-ai

### Requirement: Bubble Menu 必须提供 AI 技能子菜单并支持选区触发调用 [ADDED]

系统必须在编辑器选区 Bubble Menu 中提供 AI 技能子菜单，使用户可直接对选中文本触发 AI 操作。

- 选区存在时子菜单可见，折叠选区时子菜单隐藏。
- 子菜单按钮必须绑定稳定技能标识（润色/改写/描写/对白）并传递选中文本上下文。
- 测试必须覆盖显示与调用两条主路径，防止仅样式渲染通过。

#### Scenario: 选中文本时显示 Bubble AI 菜单 [ADDED]

- **假设** 编辑器处于可编辑状态且存在非空文本选区
- **当** Bubble Menu 更新到当前选区
- **则** 系统显示 AI 子菜单按钮组
- **并且** 折叠选区后菜单自动隐藏

#### Scenario: 点击 AI 菜单项触发对应技能调用 [ADDED]

- **假设** Bubble AI 菜单已显示且目标技能可用
- **当** 用户点击任一 AI 菜单项（如润色/改写）
- **则** 系统发起对应技能调用并传入当前选中文本
- **并且** 调用参数包含可用于后续应用结果的选区引用信息

## Out of Scope

- 固定工具栏（EditorToolbar）按钮行为变更
- 续写悬浮按钮功能
- 技能执行引擎、IPC 协议与错误码体系调整
