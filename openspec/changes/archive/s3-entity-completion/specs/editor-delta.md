# Editor Specification Delta

## Change: s3-entity-completion

### Requirement: 编辑器必须提供实体补全交互 [ADDED]

系统必须在编辑输入过程中提供实体候选补全能力，帮助用户以统一命名快速插入实体引用。

#### Scenario: S3-EC-S1 输入实体前缀时展示候选列表 [ADDED]

- **假设** 用户在编辑器中输入实体触发前缀与关键字
- **当** 系统查询到匹配实体候选
- **则** 在光标附近展示候选列表
- **并且** 支持键盘上下导航与回车确认

#### Scenario: S3-EC-S2 选择候选后插入规范化实体文本并保持输入连续性 [ADDED]

- **假设** 候选列表中存在可选实体
- **当** 用户通过键盘或鼠标确认某个候选
- **则** 编辑器插入该实体的规范化显示文本
- **并且** 光标停留在可继续输入的位置

### Requirement: 实体补全失败路径必须显式反馈且不破坏编辑状态 [MODIFIED]

系统在无候选或查询异常时必须给出可见反馈，并保持编辑器主输入流程可继续。

#### Scenario: S3-EC-S3 无候选或查询异常时展示确定性空态/错误态 [MODIFIED]

- **假设** 当前关键字无匹配实体，或实体查询临时失败
- **当** 补全流程返回空结果或错误
- **则** 展示可见的空态/错误提示
- **并且** 不清空用户已输入文本，不阻断后续输入

## Out of Scope

- 新增 TipTap 节点类型或编辑器排版能力
- 变更 AI 面板消息协议与应用逻辑
- 扩展知识图谱 schema 或实体写回流程
